<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/cast_vote.css">
    <title>
        <%= title %>
    </title>
</head>

<body>
    <div class="sidebar">
        <a href="/vote">Vote</a>
        <a href="/voters">Voters</a>
        <a href="/candidates">Candidates</a>
        <a href="/parties">Parties</a>
    </div>

    <div class="main-content">
        <div id="header">
            <h1>Cast Your Vote</h1>
        </div>
        <form action="/vote/submit_vote" method="POST" class="voting-section">
            <h2>Vote for President</h2>
            <select name="president" required onchange="showDetails(this, 'presidentDetails')">
                <option value="" disabled selected>Select a President</option>
                <% presidents.forEach(candidate=> { %>
                    <option value="<%= candidate.CandidateID %>" data-fname="<%= candidate.FirstName %>"
                        data-sname="<%= candidate.Surname %>" data-party="<%= candidate.PartyName || 'Independent' %>"
                        data-position="<%= candidate.Position %>">
                        <%= candidate.FirstName %>
                            <%= candidate.Surname %> (<%= candidate.PartyName || 'Independent' %>)
                    </option>
                    <% }); %>
            </select>
            <div id="presidentDetails"></div>
            <h2>Vote for Member of Parliament</h2>
            <select name="mp" required onchange="showDetails(this, 'mpDetails')">
                <option value="" disabled selected>Select an MP</option>
                <% mps.forEach(candidate=> { %>
                    <option value="<%= candidate.CandidateID %>" data-fname="<%= candidate.FirstName %>"
                        data-sname="<%= candidate.Surname %>" data-party="<%= candidate.PartyName || 'Independent' %>"
                        data-position="<%= candidate.Position %>">
                        <%= candidate.FirstName %>
                            <%= candidate.Surname %> (<%= candidate.PartyName || 'Independent' %>)
                    </option>
                    <% }); %>
            </select>
            <div id="mpDetails"></div>
            <h2>Vote for Councillor</h2>
            <select name="councillor" required onchange="showDetails(this, 'councillorDetails')">
                <option value="" disabled selected>Select a Councillor</option>
                <% councillors.forEach(candidate=> { %>
                    <option value="<%= candidate.CandidateID %>" data-fname="<%= candidate.FirstName %>"
                        data-sname="<%= candidate.Surname %>" data-party="<%= candidate.PartyName || 'Independent' %>"
                        data-position="<%= candidate.Position %>">
                        <%= candidate.FirstName %>
                            <%= candidate.Surname %> (<%= candidate.PartyName || 'Independent' %>)
                    </option>
                    <% }); %>
            </select>
            <div id="councillorDetails"></div>

            <button type="submit" class="submit-btn">Submit All Votes</button>
        </form>
    </div>

    <script>
        function showDetails(selectEl, detailsId) {
            const option = selectEl.options[selectEl.selectedIndex];
            if (!option || !option.value) return;

            const fname = option.getAttribute("data-fname");
            const sname = option.getAttribute("data-sname");
            const party = option.getAttribute("data-party");
            const position = option.getAttribute("data-position");

            const detailsDiv = document.getElementById(detailsId);
            detailsDiv.innerHTML = `
        <div class="profile-card">
          <div class="profile-avatar">${fname.charAt(0)}${sname.charAt(0)}</div>
          <div class="profile-info">
            <h3>${fname} ${sname}</h3>
            <p><strong>Party:</strong> ${party}</p>
            <p><strong>Position:</strong> ${position}</p>
          </div>
        </div>
      `;
        }
    </script>
</body>

</html>